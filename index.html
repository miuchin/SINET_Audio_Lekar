<!DOCTYPE html>
<html lang="sr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>SINET Audio Lekar</title>
    
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#4A90E2">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
    <link rel="stylesheet" href="css/main.css">
    <link rel="icon" href="https://cdn-icons-png.flaticon.com/512/3063/3063822.png">

    <style>
        /* Specijalni stilovi za Posvetu i Help */
        .dedication-box { margin-top:15px; padding-top:15px; border-top:1px solid rgba(0,0,0,0.1); }
        .dedication-main { font-family:'Georgia',serif; font-style:italic; font-size:1rem; color:#4A90E2; margin-bottom:5px; font-weight:bold; }
        .dedication-sub { font-family:'Georgia',serif; font-size:0.85rem; opacity:0.8; color:#333; }
        
        .help-section-title { font-weight:bold; color:#4A90E2; margin-top:15px; border-bottom:1px solid #eee; padding-bottom:5px; font-size:1.1rem; }
        .help-list { list-style: disc; padding-left: 20px; margin-top: 10px; }
        .help-list li { margin-bottom: 8px; font-size: 0.95rem; line-height: 1.4; }
    </style>
</head>
<body>

    <header class="app-header">
        <div class="logo-area">
            <h1>SINET Audio</h1>
            <button id="unlock-audio-btn" style="font-size:0.7rem; padding:4px; background:#27AE60; border:none; color:white; border-radius:4px; margin-left:10px;">ğŸ”Š AKTIVIRAJ</button>
        </div>
        <button id="menu-btn" class="hamburger-btn"><span></span><span></span><span></span></button>
    </header>

    <nav id="main-nav" class="nav-overlay">
        <div class="nav-content">
            <h2>Meni</h2>
            <ul>
                <li><a href="#" onclick="UI.showSection('home')">ğŸ  PoÄetna</a></li>
                <li><a href="#" onclick="UI.showSection('catalog')">ğŸ“š Katalog Simptoma</a></li>
                <li><a href="#" onclick="UI.showSection('favorites')">â­ Moji Favoriti</a></li>
                <li><a href="#" onclick="UI.showSection('playlist')">ğŸµ Moja Playlista</a></li>
                <hr style="border:0; border-top:1px solid #eee; margin:10px 0;">
                <li><a href="#" onclick="app.toggleHelp()">â“ DETALJNO UPUTSTVO</a></li>    
                <li><a href="#" onclick="UI.showSection('settings')">âš™ï¸ PodeÅ¡avanja</a></li>
            </ul>
            <div style="margin-top:auto; font-size:0.8rem; color:#888; text-align:center;">
                <p>Architect: miuchins</p>
                <p>Co-author: SINET AI</p>
            </div>
            <button id="close-menu-btn" class="close-btn">ZATVORI MENI</button>
        </div>
    </nav>

    <main id="app-container">
        
        <section id="section-home" class="active-section">
            <div class="welcome-msg">
                <h2>ğŸ¥ SINET Brza PomoÄ‡</h2>
                <p>Sistemski Preseti (Proverene Terapije)</p>
                
                <div class="dedication-box">
                    <p class="dedication-main">â¤ï¸ PosveÄ‡eno mojoj Veri, mome SreÄ‡ku!</p>
                    <p class="dedication-sub">Uz svo poÅ¡tovanje i svu ljubav.</p>
                </div>
            </div>

            <div id="pwa-install-promo" style="display:none; background:#e3f2fd; padding:15px; border-radius:10px; margin-bottom:20px; border:1px solid #2196f3; position:relative;">
                <span id="close-install-btn" style="position:absolute; top:5px; right:10px; font-size:1.2rem; cursor:pointer; color:#0d47a1;">&times;</span>
                <p style="margin-bottom:10px; font-weight:bold; color:#0d47a1;">ğŸ“² Instalirajte aplikaciju za rad bez interneta!</p>
                <button id="pwa-install-btn" class="ctrl-btn play" style="width:100%;">INSTALIRAJ SADA</button>
            </div>

            <div id="system-presets-container"><p style="text-align:center; color:#999;">UÄitavanje baze...</p></div>
            
            <div class="action-row">
                <button class="btn-secondary" onclick="UI.showSection('catalog')">ğŸ” PretraÅ¾i Kompletan Katalog</button>
            </div>
        </section>

        <section id="section-catalog" style="display:none;">
            <h2>Katalog Simptoma</h2>
            <div class="search-container-sticky">
                <input type="text" id="search-input" class="search-box" placeholder="ğŸ” Pretraga (npr. Glava, Zubi)..." onkeyup="app.filterCatalog()">
            </div>
            <div id="catalog-accordion"></div>
        </section>

        <section id="section-favorites" style="display:none;">
            <h2>â­ Moji Favoriti</h2>
            <div id="favorites-list"></div>
            <button class="btn-secondary" onclick="UI.showSection('catalog')">â• Dodaj novi favorit</button>
        </section>

        <section id="section-playlist" style="display:none;">
            <h2>ğŸµ Moja Playlista</h2>
            <p style="color:#666; font-size:0.9rem;">Redosled vaÅ¡ih terapija:</p>
            <div id="playlist-container" style="margin:20px 0; min-height:100px;"></div>
            <div class="action-row">
                <button id="btn-play-playlist" class="ctrl-btn play" style="width:100%; display:none;" onclick="app.startPlaylist()">â–¶ PUSTI SVE REDOM</button>
                <button class="btn-secondary" onclick="app.clearPlaylist()" style="border-color:#C0392B; color:#C0392B; margin-top:10px;">ğŸ—‘ï¸ ObriÅ¡i Listu</button>
            </div>
        </section>

        <section id="section-details" style="display:none;">
            <div class="editor-header">
                <div style="display:flex; justify-content:space-between; align-items:start;">
                    <div style="flex:1">
                        <h2 id="detail-title">Naziv</h2>
                        <p id="detail-desc">Opis...</p>
                    </div>
                    <div style="display:flex; gap:10px;">
                        <button id="fav-toggle-btn" class="fav-btn" onclick="app.toggleCurrentFavorite()">â™¡</button>
                        <button class="fav-btn" onclick="app.addToPlaylistFromEditor()" style="font-size:1.5rem;" title="Dodaj u listu">â•</button>
                    </div>
                </div>
                <div class="timer-control">
                    <label>Trajanje po frekvenciji: <strong id="timer-val-display">5 min</strong></label>
                    <input type="range" id="duration-slider" class="timer-slider" min="3" max="20" value="5" step="1" oninput="app.updateDuration(this.value)">
                </div>
                <div class="action-row" style="margin-top:0;">
                    <button class="ctrl-btn play" style="width:100%" onclick="app.startTherapyFromEditor()">â–¶ POKRENI TERAPIJU</button>
                </div>
            </div>
            <h3>Lista Frekvencija</h3>
            <ul id="editor-freq-list" class="freq-list-editor"></ul>
            <br>
            <button class="btn-secondary" onclick="UI.showSection('catalog')">â¬… Nazad na Katalog</button>
        </section>

        <section id="section-player" style="display:none;">
            <div class="player-card">
                <h3 id="current-symptom-name">Terapija</h3>
                <div class="frequency-display">
                    <span id="current-hz">0 Hz</span>
                    <span id="current-desc">Priprema...</span>
                </div>
                <div class="timer-container">
                    <div class="progress-bar-bg">
                        <div id="progress-fill" class="progress-fill" style="width: 0%"></div>
                    </div>
                    <div class="time-labels">
                        <span id="time-elapsed">00:00</span>
                        <span id="time-total">00:00</span>
                    </div>
                </div>
                <div class="controls-row">
                    <button id="btn-stop" class="ctrl-btn stop">â¹ STOP</button>
                    <button id="btn-play-pause" class="ctrl-btn play">â¸ PAUZA</button>
                </div>
                <div id="playlist-status" style="margin-top:15px; font-weight:bold; color:#4A90E2; display:none; text-align:center;">
                    ğŸµ Playlista: <span id="playlist-counter">1/3</span>
                </div>
                <div id="resume-notify" class="resume-box" style="display:none">
                    <p>Nastaviti gde ste stali?</p>
                    <button>DA, NASTAVI</button>
                </div>
            </div>
            <button class="btn-secondary" style="margin-top:20px" onclick="UI.showSection('details')">âš™ Izmeni Postavke</button>
        </section>

        <section id="section-settings" style="display:none;">
            <h2>âš™ï¸ PodeÅ¡avanja</h2>
            <div class="settings-card">
                <h3>Izgled</h3>
                <div class="setting-row">
                    <span>ğŸŒ™ Tamna Tema</span>
                    <label class="switch"><input type="checkbox" id="theme-toggle" onchange="app.toggleTheme(this.checked)"><span class="slider round"></span></label>
                </div>
                <div class="setting-row">
                    <span>ğŸ” UveÄ‡ana Slova</span>
                    <label class="switch"><input type="checkbox" id="font-toggle" onchange="app.toggleFontSize(this.checked)"><span class="slider round"></span></label>
                </div>
            </div>
            <div class="settings-card">
                <h3>ğŸ’¾ Podaci (Backup)</h3>
                <p style="font-size:0.85rem; color:#666; margin-bottom:15px;">SaÄuvajte svoje favorite i podeÅ¡avanja.</p>
                <button class="btn-secondary" onclick="app.exportData()">ğŸ“¤ IZVEZI PODATKE (BACKUP)</button>
                <div style="margin-top:15px; border-top:1px solid #eee; padding-top:15px;">
                    <input type="file" id="import-file" style="display:none" onchange="app.importData(this)">
                    <button class="btn-secondary" onclick="document.getElementById('import-file').click()">ğŸ“¥ UVEZI PODATKE (RESTORE)</button>
                </div>
            </div>
            <div class="settings-card" style="border-color: #e74c3c;">
                <h3 style="color:#c0392b">Opasna Zona</h3>
                <button class="btn-secondary" style="border-color:#c0392b; color:#c0392b" onclick="app.resetAllData()">ğŸ—‘ï¸ OBRIÅ I SVE</button>
            </div>
            <div style="margin-top:20px; font-size:0.8rem; color:#666; text-align:center">
                <p><strong>SINET Audio v4.1</strong></p>
                <p>Architect: miuchins & SINET AI</p>
            </div>
        </section>

    </main>

    <script src="js/db/indexed-db.js"></script>
    <script type="module" src="js/app.js"></script>

    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('service-worker.js').then(reg => console.log('SW OK')).catch(err => console.log('SW Fail', err));
            });
        }
        
        let deferredPrompt;
        const installBox = document.getElementById('pwa-install-promo');
        const installBtn = document.getElementById('pwa-install-btn');
        const closeBtn = document.getElementById('close-install-btn');

        if (window.matchMedia('(display-mode: standalone)').matches) {
            installBox.style.display = 'none';
        } else {
            window.addEventListener('beforeinstallprompt', (e) => {
                e.preventDefault();
                deferredPrompt = e;
                installBox.style.display = 'block';
            });
        }

        if(installBtn) installBtn.addEventListener('click', (e) => {
            installBox.style.display = 'none';
            deferredPrompt.prompt();
        });

        if(closeBtn) closeBtn.addEventListener('click', (e) => {
            installBox.style.display = 'none';
        });
    </script>

    <div id="help-modal" class="modal-overlay" style="display:none;">
        <div class="modal-content" style="max-height: 80vh; overflow-y: auto;">
            <div class="modal-header">
                <h3>ğŸ“– Uputstvo za KoriÅ¡Ä‡enje</h3>
                <button class="close-modal" onclick="app.toggleHelp()">âœ–</button>
            </div>
            <div class="modal-body">
                
                <div class="help-section-title">1. KAKO POÄŒETI?</div>
                <ul class="help-list">
                    <li><strong>Brza PomoÄ‡:</strong> Na poÄetnoj strani su najvaÅ¾niji programi (Zubi, Glava, LeÄ‘a). Samo kliknite na karticu da otvorite terapiju.</li>
                    <li><strong>Katalog:</strong> Ako ne vidite svoj problem, kliknite na dugme "PretraÅ¾i Katalog" i upiÅ¡ite simptom (npr. "Sinusi" ili "Stres").</li>
                    <li><strong>Start:</strong> Kada uÄ‘ete u detalje terapije, pritisnite veliko zeleno dugme â–¶ POKRENI TERAPIJU.</li>
                </ul>

                <div class="help-section-title">2. SAVETI ZA ZDRAVLJE</div>
                <ul class="help-list">
                    <li>ğŸ’§ <strong>Voda:</strong> Obavezno popijte ÄaÅ¡u vode pre i posle terapije. Zvuk pokreÄ‡e detoksikaciju tela i voda je neophodna da se toksini izbace.</li>
                    <li>ğŸ§ <strong>SluÅ¡alice:</strong> Za programe za mozak (Brainwave) i nerve su obavezne. Za telo (Rife frekvencije) moÅ¾ete koristiti i zvuÄnik telefona (naslonite telefon na bolno mesto).</li>
                    <li>â³ <strong>Trajanje:</strong> PreporuÄujemo 3 do 5 minuta po jednoj frekvenciji (ukupna terapija oko 15-20 min).</li>
                </ul>

                <div class="help-section-title">3. NAPREDNE OPCIJE</div>
                <ul class="help-list">
                    <li><strong>Playlista:</strong> MoÅ¾ete sastaviti svoju listu terapija (npr. Zubi + Glava + San). Kliknite na dugme â• u editoru da dodate terapiju u listu.</li>
                    <li><strong>Offline Rad:</strong> Instalirajte aplikaciju klikom na dugme "Instaliraj" i ona Ä‡e raditi bez interneta zauvek.</li>
                </ul>

                <hr>
                <p style="font-size:0.8rem; text-align:center; color:#666;">
                    <strong>Napomena:</strong> SINET Audio je pomoÄ‡no sredstvo za relaksaciju i eksperimentalnu upotrebu.<br>Nije zamena za zvaniÄnu medicinu i lekara.<br>
                    <em>Made with â¤ï¸ by miuchins</em>
                </p>
            </div>
            <button class="ctrl-btn play" style="width:100%; margin-top:10px;" onclick="app.toggleHelp()">RAZUMEM, HVALA</button>
        </div>
    </div>

</body>
</html>
